The scripts are intended to reproduce the figures as they appear in the manuscript and to document the modelling and plotting choices used in each case.

---

## Repository structure
```
.
├── figures/ # Code to generate the final figures included in the paper
├── src/ # Parameters, helper functions, and custom plotting utilities
├── velocities/ # Analytical velocity profiles derived in the Supplementary Material,
│ # used to generate figures
└── outputs/ # Location where generated figures are saved 
```

Figure 2 shows P\'eclet number Pe as amplitude A and frequency \omega are varied. Generate fig 2 from python3 figures/pe_A_vs_alpha.py. Output saves to "outputs/pe_A_vs_alpha_human_mouse.png". Note that the little humans and mice are added in latex doc. 

Figure 4 shows plots of the steady streaming, Stokes drift and production--drainge velocity profiles. Generate fig 4 from python3 figures/flow_profiles.py. Output saves to "outputs/multiple_flow_profiles.png". 

Figure 5 shows the maximum magnitudes of u_i and the dimensional profiles associated with Lagrangian velocities for different A. Generate fig 5 from python3 figures/comp_A_and_profiles.py. Output saves to "outputs/max_vs_A_and_stacked_profiles.png". Note: takes a few minutes to run due to resolution.

Figure 6 shows the steady streaming P\'eclet number as A and alpha are varied. Generate fig 6 from python3 figures/pe_s_regime.py. Output saves to "outputs/pe_osc_regime_logscale_u.png". Note: takes a couple of minutes to run due to resolution. Little humans and mice added in latex doc.

Figures 8, 9, 11 are produced from simulations run using the fenics code provided. The simulation .pvd files are then viewed using paraview, from where they are saved with translucant backgrounds. These figures are saved to figure/paraview figs in the appropriate folder for the figures. These figures are then processed using the python code here to generate the final figures. 

Figure 8 shows time snaps of bolus simulations as A is varied. The code is in figures/case_study_1. To produce the figure, three code files must be run sequentially: python3 figures/case_study_1/concentration_int.py, python3 figures/case_study_1/pre_stack.py, 
python3 figures/case_study_1/combined_fig.py. Output saves to "outputs/case_study_1.png". Note: This script requires pre-saved images from simulations
run using fenics code and saved to the designated folder.

Figure 9 shows the time snaps and steady states for a point leak with advection by steady streaming alone, and with production--drainge flow
included. The code is in figures/case_study_2/point_leak_combined. To produce the figure, three code files must be run sequentially: python3
figures/case_study_2/point_leak_combined/point_leak_rename.py, python3 figures/case_study_2/point_leak_combined/pd_point_leak_rename.py,
python3 figures/case_study_2/point_leak_combined/point_leak_combined.py. Output saves to "outputs/point_leak_combined_0.8.png". Note: This script requires pre-saved images from simulations
run using fenics code and saved to the designated folder.

Figure 10 gives a summary of steady-state mass accumulation and drainage. Generate fig 10 by running python3 figures/case_study_2/mass_and_drainage.py. Post-processes steady-state simulation outputs across a range of oscillatoryPéclet numbers and generates a summary figure comparing total solute mass and AG drainage for point-leak cases (multiple leak locations) and a full-brain reference, with and without production–drainage flow. Saves the final 2×2panel figure to `outputs/concentration/mass_vs_AG_2x2.png`. Note: This script reads simulation outputs from a hard-coded local directory and
may require updating `base_path` to match your file system.

Figure 11 shows the steady states for a solute leaking from the spinal canal at different $Pe_s$ with and without production--drainage flow. The
code is in figures/case_study_3/. The figure is generated by running three code files sequentially, python3 figures/case_study_3/spine_leak_rename.py,
python3 figures/case_study_3/pd_spine_leak_rename.py, python3 figures/case_study_3/spine_leak_combined.py. The output is saved at "outputs/spine_leak_combined.png". Note: This script requires pre-saved images from simulations
run using fenics code and saved to the designated folder.

